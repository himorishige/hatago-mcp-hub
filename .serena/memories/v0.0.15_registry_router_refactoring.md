# v0.0.15 Registry & Router Refactoring

## Overview

Major refactoring aligned with Hatago's "thin implementation" philosophy, achieving ~1000 lines of code reduction.

## Key Changes

### ToolRegistry (65% reduction: 361→128 lines)

- Removed 6 complex naming strategies (none, prefix, suffix, namespace, custom, hybrid)
- Simplified to single `serverId_toolName` format
- Removed collision detection - uses first-come-first-served approach
- Constructor no longer accepts options parameter

### Router (69% reduction: 333→102 lines)

- Removed all statistics and metrics tracking
- Removed grouping functions
- Deleted router-functional.ts and router-types.ts
- Pure routing only

### ResourceRegistry (17% reduction: 178→147 lines)

- Changed from factory pattern to class-based
- **Important**: Resources use original URI (not namespaced) for MCP compliance
- Maintains server filtering capability

## Test Updates

- Updated all E2E tests from `__` to `_` separator
- Example: `test__echo` → `test_echo`

## Files Deleted

- packages/runtime/src/router/router-functional.ts (150 lines)
- packages/runtime/src/router/router-types.ts (50 lines)
- packages/runtime/src/registry/types.ts (50 lines)
- packages/runtime/src/utils/naming-strategy.ts (100 lines)

## Results

- All 402 tests passing
- Build successful
- Achieved Hatago's "thin implementation" philosophy
